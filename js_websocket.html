<html>
    <style>
        #status{
            background-color: red;
            font-size: 18;
            font-weight: bold;
            line-height: 140%;
            width: 50%;
            padding: 5;
            margin: 4;

        }
        #messages{
            background-color: yellow;
            font-size: 13;
            font-weight: bold;
            line-height: 140%;

        }
    </style>
    <head>
        <title>Websocket Using Javascript MQTT Client</title>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.0.1/mqttws31.js" type="text/javascript"></script>
    
    
        <script type="text/javascript">
                function MQTTconnect(){
                    document.getElementById("messages").innerHTML = "";
                    var s = document.forms["connectionform"]["server"].value;
                    var p = document.forms["connectionform"]["port"].value;

                    if(p!="")
                    {
                        console.log("ports");
                                port = parseInt(p)
                                console.log("port" + port);

                    }

                    if(s!="")
                    {
                        //host =s;
                        console.log("host");
                    }

                    console.log("Connecting to " + host + " "+ port);

                    rango = new Paho.MQTT.Client(host,port,"Sohan");

                    var options ={
                        timeout :  3,
                        userName: "sohan",
                        password: "1234",
                        onSuccess: onConnect,
                        onFailure: onFailure,

                    };
                    rango.connect(options);
                    return false;

                }

        </script>
    </head>

    <body>
        <h1>Websocket Using Javascript MQTT Client</h1>
        <script type="text/javascript">

        </script>
        <script>
            var connected_flag = 0;
            var rango;
            var reconnectTimeout = 2000;
            var host = "192.168.0.102";
            var port = 9001;
        </script>

        <div id="status">
            Connection Status: Not Connected
        </div> <br>
        <form name="connectionform" action="" onsubmit="return MQTTconnect()">
            Server: <input type="text" name="server"><br><br>
            Port:   <input type="text" name="port"><br><br>
            <input type="submit" value="Connect">
        </form>  
        <hr>

        <form name="subs" action="" onsubmit="return sub_topics()">
            Subscribe Topics: <input type="text" name="Stopic"><br><br>
            <input type="submit" value="Subscribe">

        </form>
        <hr>

        <form name="smessage" action="" on onsubmit="return send_message()">
            Message:        <input type="text" name="message"><br><br>
            Publish Topic:  <input type="text" name="Ptopic"><br><br>
            <input type="submit" value="Submit">


        </form>
        Message: <p id="messages"></p>
    </body>
</html>